# Flow: استيراد الموردين (import_suppliers)

## الهدف
استيراد بيانات الموردين من ملف (CSV/XLSX) مع تحقق شامل للبيانات.

## المسار الأساسي
1) الطلب: `/api/import_suppliers.php` برفع ملف.
2) التحقق:
   - حجم ونوع الملف ضمن الحدود.
   - الأعمدة المطلوبة موجودة (name, email, phone, country, tax_id...).
3) التنفيذ:
   - قراءة السجلات.
   - تحقق لكل سجل (Email/Phone/Tax/بلد).
   - إدراج/تحديث الموردين.
4) المخرجات:
   - JSON ملخّص (عدد ناجح، عدد فاشل، أخطاء مفصلة).
   - حدث runtime_events `import_suppliers` مع counters.

## الأخطاء الشائعة
- حجم/نوع ملف غير مقبول → 400.
- أعمدة ناقصة → 422.
- سجلات كثيرة الأخطاء → يعاد import_failure مع قائمة أخطاء.

## الحواجز
- Playbook data_validation (Email/Phone/Tax).
- Import safety (حجم/نوع، Sanitization).
- Audit لنتائج الاستيراد (ملف سجل أو جدول).

## معايير القبول
- ملف خاطئ النوع → 400 ورسالة واضحة.
- سجل به Email سيئ → يظهر في أخطاء مفصلة ولا يمنع بقية السجلات الصحيحة.
- نجاح ≥99% وفق KPI import_success_rate.
