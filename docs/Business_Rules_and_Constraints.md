# Business Rules & System Constraints
## Banking Guarantees Management System

### 1. Mandatory Data Integrity Rules
**(ููุงุนุฏ ุณูุงูุฉ ุงูุจูุงูุงุช ุงูุฅูุฒุงููุฉ)**

#### BR-01 โ Mandatory Fields
ูู ุถูุงู ุจููู ูุฌุจ ุฃู ูุญุชูู ุฅูุฒุงูููุง ุนูู ุงูููู ุงูุชุงููุฉ:
- **Supplier Name** (ุงุณู ุงูููุฑุฏ)
- **Bank Name** (ุงุณู ุงูุจูู)
- **Guarantee Amount** (ุงููููุฉ)
- **Expiry Date** (ุชุงุฑูุฎ ุงูุงูุชูุงุก)
- **Contract Number** ุฃู **Purchase Order Number**

#### BR-02 โ Entry Prevention Rule
ุฃู ุถูุงู ุจููู ูุง ูุญุชูู ุนูู ุฌููุน ุงูุญููู ุงูุฅูุฒุงููุฉ ุงูุฎูุณุฉ:
- ููููุน ุฅุฏุฎุงูู ุฅูู ุงููุธุงู
- ูุง ูููุดุฃ ูู ุณุฌู ุฌุฒุฆู ุฃู ูุคูุช

#### BR-03 โ Validation Timing Rule
ูุชู ุงูุชุญูู ูู ุงูุชูุงู ุงูุญููู ุงูุฅูุฒุงููุฉ ุนูุฏ ูุญุธุฉ ุงูุฅุฏุฎุงู ูู ุฌููุน ูุณุงุฑุงุช ุงูุฅุฏุฎุงู:
- ุงูุงุณุชูุฑุงุฏ ูู ููู
- ุงููุตู ุงูุฐูู
- ุงูุฅุฏุฎุงู ุงููุฏูู

#### BR-04 โ Data Cleanup Rule
ุฃู ุณุฌู ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ูุญุชูู ุนูู ุฌููุน ุงูุญููู ุงูุฅูุฒุงููุฉ ุงูุฎูุณุฉ:
- ููุญุฐู
- ูุง ููุฑุญููู
- ูุง ููุนุฑุถ ูู ุงููุงุฌูุฉ
- *ูุฌูุฏ ุญููู ุฅุถุงููุฉ ูุณููุญ ุจู.*

---

### 2. UI Display & Edit Constraints
**(ูููุฏ ุงููุงุฌูุฉ ูุงูุนุฑุถ)**

#### SC-01 โ Info Grid Display-Only Constraint
ูุงุฌูุฉ **Info Grid**:
- ููุนุฑุถ ููุท
- ูุง ุชุณูุญ ุจุฃู ุชุนุฏูู ูุจุงุดุฑ
- ูุง ุชูุณุชุฎุฏู ููุตุฏุฑ ุฅุฏุฎุงู

#### SC-02 โ Guaranteed Completeness Rule
ูู ูุง ููุนุฑุถ ูู Info Grid ูุฌุจ ุฃู ูููู:
- ููุชูู ุงูุจูุงูุงุช
- ูุนูู (ุขุฎุฑ ุญุงูุฉ)
- ุบูุฑ ูุงุฑุบ

---

### 3. User Edit Permissions
**(ุตูุงุญูุงุช ุงููุณุชุฎุฏู)**

#### BR-05 โ Limited Manual Edit Rule
ุงููุณุชุฎุฏู ูุณููุญ ูู ุจุงูุชุนุฏูู ุงููุฏูู ููุท ุนูู:
- ุงุณู ุงูููุฑุฏ
- ุงุณู ุงูุจูู
*ููุชู ุฐูู ุญุตุฑููุง ุนุจุฑ:*
- ุงูุชุนุฏูู
- ุงูุถุบุท ุนูู ุฒุฑ **ุญูุธ**

#### BR-06 โ Controlled Field Modification Rule
ุชุนุฏูู ุงูุญููู ุงูุชุงููุฉ ูุชู ููุท ุนุจุฑ ุฃุฒุฑุงุฑ ูุฎุตุตุฉ:
- **Expiry Date** โ ุฒุฑ **ุชูุฏูุฏ**
- **Guarantee Amount** โ ุฒุฑ **ุชุฎููุถ**
- **Status / Lifecycle** โ ุฒุฑ **ุฅูุฑุงุฌ**

#### BR-07 โ Forbidden Manual Edits Rule
ุฃู ุชุนุฏูู ูุฏูู ูุจุงุดุฑ ุฎุงุฑุฌ ูุง ุณุจู:
- ุบูุฑ ูุณููุญ
- ูุฑููุถ ููุทูููุง ูุชููููุง

---

### 4. User Actions & Database Consistency
**(ุงูุฃุฒุฑุงุฑ ูุชูุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช)**

#### BR-08 โ Action-Based Modification Rule
ูุง ูุชู ุฃู ุชุบููุฑ ุนูู ุจูุงูุงุช ุงูุถูุงู ุฅูุง ูุชูุฌุฉ:
- ุถุบุท ุฒุฑ ุตุฑูุญ ูู ุงููุณุชุฎุฏู
- ุฃู ุชุญุฏูุซ ูุธุงูู ุฏุงุฎูู (Learning / Matching)

#### BR-09 โ Dual Write Rule
ุนูุฏ ุถุบุท ุงููุณุชุฎุฏู ุนูู ุฃู ุฒุฑ ูู ุงูุฃุฒุฑุงุฑ ุงูุชุงููุฉ (ุญูุธุ ุชูุฏูุฏุ ุชุฎููุถุ ุฅูุฑุงุฌ)ุ ูุฌุจ ุนูู ุงููุธุงู ุชูููุฐ ุนูููุชูู ุฅุฌุจุงุฑูุชูู ููุชุฒุงููุชูู:
1. **ุชุญุฏูุซ ุงูุณุฌู ุงูุฃุณุงุณู**
   - ุชุญุฏูุซ ุจูุงูุงุช ุงูุถูุงู ูู ุงูุฌุฏูู ุงูุฑุฆูุณู
   - ุชุนูุณ ุงูููู ุขุฎุฑ ุญุงูุฉ ูุนููุฉ ููุถูุงู
2. **ุฅูุดุงุก Snapshot ุชุงุฑูุฎู**
   - ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ ูู ุฌุฏูู ุงูุชุงุฑูุฎ
   - ูุญุชูู ุนูู ุญุงูุฉ ุงูุถูุงู ูุจู ุชูููุฐ ุงูุญุฏุซ
   - *ููุญูุธ ูุฃุบุฑุงุถ ุงูุชุชุจุน ููุท*

---

### 5. History & Timeline Rules
**(ููุงุนุฏ ุงูุชุงุฑูุฎ ูุงูุชุงูู ูุงูู)**

#### BR-10 โ Immutable History Rule
ุฌููุน ุงูุณุฌูุงุช ุงูุชุงุฑูุฎูุฉ:
- ููุนุฑุถ ููุท
- ุบูุฑ ูุงุจูุฉ ููุชุนุฏูู
- ุบูุฑ ูุงุจูุฉ ููุญุฐู ูู ูุจู ุงููุณุชุฎุฏู
- ูุง ุชุคุซุฑ ุนูู ุงูุญุงูุฉ ุงูุญุงููุฉ ููุถูุงู

#### BR-11 โ Event-Centric Snapshot Rule
ูู ุณุฌู ุชุงุฑูุฎู ูุฌุจ ุฃู ูุญุชูู ุนูู:
- ููุน ุงูุญุฏุซ (Save / Extend / Reduce / Release / System Update)
- ุชุงุฑูุฎ ูููุช ุงูุชูููุฐ
- ูุตุฏุฑ ุงูุชุบููุฑ (User / System)
- ูุฑุฌุน ูุงุถุญ ููุถูุงู ุงูุฃุณุงุณู

#### BR-12 โ Timeline Read-Only Projection
ูุงุฌูุฉ Timeline:
- ุชุนุฑุถ ุงูุชุงุฑูุฎ ููุท
- ูุง ุชุญุชูู ุนูู ุฃุฏูุงุช ุชุนุฏูู
- ูุง ุชูุณุชุฎุฏู ูุงุณุชุฑุฌุงุน ุฃู ุชุนุฏูู ุงูุญุงูุฉ ุงูุญุงููุฉ

---

### 6. System-Driven Updates
**(ุชุญุฏูุซุงุช ุงููุธุงู ุงูุฎูููุฉ)**

#### BR-13 โ Background System Adjustments
ูุฏ ูููู ุงููุธุงู ุจุชุญุฏูุซ:
- ุงุณู ุงูููุฑุฏ
- ุงุณู ุงูุจูู
*ููู:*
- ุฏุฑุฌุงุช ุงูุชุทุงุจู
- ูุธุงู ุงูุชุนูู

*ูุฐู ุงูุชุญุฏูุซุงุช:*
- ูุง ุชุชู ุนุจุฑ ุงููุงุฌูุฉ
- ูุง ุชุฑุชุจุท ุจุฃุฒุฑุงุฑ ุงููุณุชุฎุฏู
- ุชูุณุฌููู ูุณุฌู ุชุงุฑูุฎู ููุท

---

### 7. System Principles
**(ุงููุจุงุฏุฆ ุงูุญุงููุฉ)**

#### PR-01 โ Single Source of Truth
ุงูุฌุฏูู ุงูุฑุฆูุณู ููุถูุงู:
- ูู ุงููุตุฏุฑ ุงููุญูุฏ ููุญุงูุฉ ุงูุญุงููุฉ
- ูุง ููุดุชู ูู ุงูุชุงุฑูุฎ
- ูุง ููุนุฏู ุนุจุฑ ุงูุชุงุฑูุฎ

#### PR-02 โ Action โ State โ History Principle
ุฃู ุชุบููุฑ ููุฑ ุฏุงุฆููุง ุจุงูุชุณูุณู ุงูุชุงูู ููุท:
`User/System Action โ Update Current Guarantee โ Persist Historical Snapshot โ Refresh UI`
ููุง ููุณูุญ ุจุฃู ูุณุงุฑ ุจุฏูู.

---

### 8. Guarantee Status Transition Policy
**(ุณูุงุณุฉ ุชุญููู ุญุงูุฉ ุงูุถูุงู ุงูุจููู โ Score-Based / Implementation-Agnostic)**

#### P7-1. Purpose & Scope
ุชูุธู ูุฐู ุงูุณูุงุณุฉ:
- ููุทู ุชุญููู ุญุงูุฉ ุงูุถูุงู
- ุงูุนูุงูุฉ ุจูู ุฏุฑุฌุฉ ุงููุทุงุจูุฉุ ูุฑุงุฑ ุงููุณุชุฎุฏูุ ูุณูุงุณุงุช ุงููุธุงู
- *ุฏูู ุงูุชุฏุฎู ูู ุชูุงุตูู ุฎูุงุฑุฒููุงุช ุงููุทุงุจูุฉ ุฃู ุฃูุฒุงููุง*

#### P7-2. Canonical Guarantee States
- **GS-01 โ Needs Decision**
- **GS-02 โ Ready**

#### P7-3. Explicit Non-States
- ููุต ุงูุจูุงูุงุช ููุณ ุญุงูุฉ (ุฑุงุฌุน BR-02)
- ูุง Draft / Partial / Pending

#### P7-4. Decision-Critical Fields
- **Supplier**
- **Bank**
*ููุท ูุฐุงู ุงูุญููุงู ูุคุซุฑุงู ุนูู ุงูุญุงูุฉ.*

#### P7-5. Matching Score Model
**(ูููุฐุฌ ุฏุฑุฌุฉ ุงููุทุงุจูุฉ โ ุจุฏูู ุงูุชุฑุงุถุงุช ุฎูุงุฑุฒููุฉ)**
ูู ุงูุชุฑุงุญ ุชุทุงุจู (Supplier ุฃู Bank) ูุฌุจ ุฃู ููุชุฌ ุนูู ุงูุฃูู:
- **Score**: ุฑูู ูู 0 ุฅูู 100
- **Context**: ูุนูููุงุช ูุงููุฉ ูุชุญุฏูุฏ:
    - ูุฌูุฏ ุชุนุงุฑุถ ูู ุนุฏูู
    - ูุตุฏุฑ ุงูุงูุชุฑุงุญ (Canonical / Alias / Learning / Guess)
*โ ูุฐู ุงูุณูุงุณุฉ ูุง ุชูุชุฑุถ ููู ุญูุณุจุช ุงูุฏุฑุฌุฉ ุฃู ุงูุนูุงูู ุงููุณุชุฎุฏูุฉ.*

#### P7-6. Confidence Interpretation (Policy-Level)
ุงูุณูุงุณุฉ ุชุชุนุงูู ูุน ุงูุฏุฑุฌุฉ ููุทุงูุงุช ุฏูุงููุฉุ ูููุณ ููุนุงุฏูุฉ:
- **High Confidence**: ุฏุฑุฌุฉ ูุฑุชูุนุฉ ุจุฏูู ุชุนุงุฑุถ ููู ูุตุฏุฑ ููุซูู
- **Medium Confidence**: ุฏุฑุฌุฉ ูุชูุณุทุฉ ุฃู ูุฑุชูุนุฉ ููู ุจุฏูู ุชุฃููุฏ ุตุฑูุญ
- **Low Confidence**: ุฏุฑุฌุฉ ููุฎูุถุฉ ุฃู ูุงุชุฌุฉ ุนู ุชุฎููู
*ุชุญููู ุงูุฏุฑุฌุฉ ุงูุฑูููุฉ ุฅูู ูุฐู ุงููุฆุงุช ูุชู ุนุจุฑ ููุทู ูุฑูุฒู ูู ุงูููุฏ. ุงูุณูุงุณุฉ ูุง ุชูุญุฏููุฏ ุญุฏููุง ุฑููููุง ุตุฑูุญูุง.*

#### P7-7. Resolution Definition
**(ูุชู ููุนุชุจุฑ ุงูููุฑุฏ/ุงูุจูู ูุญุณูููุง)**
ููุนุชุจุฑ Supplier ุฃู Bank **Resolved** ุฅุฐุง ุชุญูู ุฃุญุฏ ุงูุชุงูู:
1. ูุญููู ุนููู ูู **High Confidence** (ุจุฏูู ุชุนุงุฑุถ ูุจูุตุฏุฑ ููุซูู).
2. ุฃู **ุงููุณุชุฎุฏู ุซุจูุช ุงูุงุฎุชูุงุฑ ุตุฑุงุญุฉ** (ุนุจุฑ ุฒุฑ Save ูุชู ุชุณุฌูู ุงููุฑุงุฑ ุชุงุฑูุฎููุง BR-09).

*ูุง ููุนุชุจุฑ Resolved ุฅุฐุง:*
- ุงูุฏุฑุฌุฉ ูุญุฏูุง ุนุงููุฉ ููู ุงูุณูุงู ุบูุฑ ูุญุณูู
- ุฃู ููุฌุฏ ุชุนุงุฑุถ
- ุฃู ูู ููุฌุฏ ูุฑุงุฑ ูุณุชุฎุฏู

#### P7-8. Status Evaluation Rule
**(ูุงุนุฏุฉ ุชุญุฏูุฏ ุงูุญุงูุฉ โ ุบูุฑ ูุฑุชุจุทุฉ ุจุงูุฃูุฒุงู)**
- **Ready** ุฅุฐุง:
    - Supplier Resolved
    - Bank Resolved
    - ูุง ุชูุฌุฏ Conflict Flags
    - ุงูุญููู ุงูุฅูุฒุงููุฉ ููุชููุฉ (BR-01)
- **Needs Decision** ูู ุฌููุน ุงูุญุงูุงุช ุงูุฃุฎุฑูุ ููููุง:
    - ุฃู ุนูุตุฑ ุบูุฑ Resolved
    - ูุฌูุฏ ambiguity
    - ุชุนุงุฑุถ ูุงุชุฌ ุนู ุฅุนุงุฏุฉ ุชูููู

#### P7-9. Role Separation
- **User**: ูุญุณูุ ูุง ูุญุณุจ. ูุฑุงุฑู ูุชุฌุงูุฒ ุฃู Score. ูุชู ุนุจุฑ Save ููุท.
- **Matching Engine**: ูุญุณุจ ุงูุฏุฑุฌุงุชุ ูุญุฏุฏ ุงูุณูุงูุ ูุง ูุบููุฑ ุงูุญุงูุฉ ูุจุงุดุฑุฉ.
- **Learning System**: ูุญุณูู ุงูุงูุชุฑุงุญุงุชุ ูุคุซุฑ ุนูู ุงูุฏุฑุฌุงุช ูุณุชูุจููุงุ ูุง ูุญุณู ููุง ูุบููุฑ ุงูุญุงูุฉ ูุญุฏู.

#### P7-10. Authorized Transition Triggers
- ุฅุฏุฎุงู ุฌุฏูุฏ
- Save ูู ุงููุณุชุฎุฏู
- ุชุญุฏูุซ ุงูููุงููุณ

#### P7-11. Reverse Transition Rules
**Ready โ Needs Decision** ููุท ุนูุฏ:
- ุชุนุฏูู ุงูููุฑุฏ/ุงูุจูู
- ุธููุฑ ุชุนุงุฑุถ
- ุชุบููุฑ ูุงููุณ ูุคุซุฑ
*ูููุณุฌูู ูู Timeline (BR-10).*

#### P7-12. Single Authority Principle
**(ูุจุฏุฃ ุจุงูุบ ุงูุฃูููุฉ ููุง)**
- ุงูุณูุงุณุฉ ุชูุณูุฑ
- ุงูููุฏ ูุญุณุจ
- ููุง ููุฌุฏ ุชุฏุงุฎู ุจููููุง. ุงูุณูุงุณุฉ ูุง ุชุนุฑู ุฃูุฒุงู ุฃู ูุนุงุฏูุงุช.

#### P7-13. Integration References
- ูุชูุงููุฉ ูุน Business Rules
- ููุชุฒูุฉ ุจู Dual Write + Snapshot
- ูุง ุชูุณ Info Grid

#### P7-14. Final Governing Principle
**(ูุญุฏูุซ ุจุฏูุฉ)**
- ุงูููุฏ ููููู
- ุงูุณูุงุณุฉ ุชูุณูุฑ
- ุงููุณุชุฎุฏู ูุญุณู
- ูุงููุธุงู ููุซูู

---

### 9. Timeline Event Matrix โ Final (Updated)
**(When ร Who ร What ร Why)**
*Scope: ููุท ุงูุถูุงูุงุช ุงูุชู ุฏุฎูุช ุงููุธุงู ุจูุฌุงุญ (ุจุนุฏ ุงูุงุณุชูุฑุงุฏ).*

#### 0๏ธโฃ Lifecycle โ Import (Mandatory First Event)
| Code | Event | When | Who | What | Why |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **LE-00** | Import Guarantee | ุนูุฏ ูุฌุงุญ ุงุณุชูุฑุงุฏ ุงูุถูุงู | System | Import | Entry Point |

- **Title**: ุงุณุชูุฑุงุฏ ุงูุถูุงู
- **Description**: ุงููุตุฏุฑ: ููู Excel \| ูุตู ุฐูู \| ุฅุฏุฎุงู ูุจุงุดุฑ
- **Footer**: ุจูุงุณุทุฉ ุงููุธุงู
- **๐ ููุงุนุฏ ุญุงููุฉ**:
    - ุฃูู ุญุฏุซ ุฒููู ูุฃู ุถูุงู ุฅูุฒุงูููุง.
    - ูุณุจู ุฃู Matching / Conflict / Decision.
    - ูุง ููุนุงุฏ ุชุณุฌููู.

#### 1๏ธโฃ User Action Events
| Code | Event | When | Who | What | Why |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **UE-01** | User Saved Decision | ุจุนุฏ Save ูุน ุชุบููุฑ ูุนูู | User | Supplier/Bank | UserDecision |
| **UE-02** | User Extended Guarantee | ุจุนุฏ Extend | User | Expiry Date | Extend |
| **UE-03** | User Reduced Guarantee | ุจุนุฏ Reduce | User | Amount | Reduce |
| **UE-04** | User Released Guarantee | ุจุนุฏ Release | User | Lifecycle Status | Release |

**Titles & Descriptions:**
- **UE-01**: "ุงุนุชูุงุฏ ุจูุงูุงุช ุงูููุฑุฏ ุฃู ุงูุจูู" (ุงูููุฑุฏ: โฆ โ โฆ)
- **UE-02**: "ุชูุฏูุฏ ุงูุถูุงู" (ุชุงุฑูุฎ ุงูุงูุชูุงุก: โฆ โ โฆ)
- **UE-03**: "ุชุฎููุถ ูููุฉ ุงูุถูุงู" (ุงููุจูุบ: โฆ โ โฆ)
- **UE-04**: "ุฅูุฑุงุฌ ุงูุถูุงู" (ุงูุญุงูุฉ: โฆ โ โฆ)

#### 2๏ธโฃ Status Transition Events
*(System Triggered ุญุชู ูู ูุงู ุณุจุจูุง ูุฑุงุฑ ุงููุณุชุฎุฏู)*

| Code | Event | When | Who | What | Why |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **SE-01** | Needs Decision โ Ready | ุจุนุฏ ุฅุนุงุฏุฉ ุชูููู | System | Status | Resolution |
| **SE-02** | Ready โ Needs Decision | ุจุนุฏ ุฅุนุงุฏุฉ ุชูููู | System | Status | Conflict/Reeval |

**Titles:**
- **SE-01**: "ุงูุถูุงู ุฌุงูุฒ"
- **SE-02**: "ูุญุชุงุฌ ูุฑุงุฌุนุฉ"

#### 3๏ธโฃ System Adjustment Events
| Code | Event | When | Who | What | Why |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **SY-01** | System Updated Supplier Name | ุจุนุฏ ุชุญุฏูุซ ูุนูู | System | Supplier Name | Normalization |
| **SY-02** | System Updated Bank Name | ุจุนุฏ ุชุญุฏูุซ ูุนูู | System | Bank Name | Normalization |
| **SY-03** | System Re-evaluated Matching | ุจุนุฏ Re-evaluation (ููุท ุฅุฐุง ุบููุฑ ุงูุญุงูุฉ) | System | Status Context | Reeval |

**Titles:**
- **SY-01**: "ุชุญุฏูุซ ุงุณู ุงูููุฑุฏ"
- **SY-02**: "ุชุญุฏูุซ ุงุณู ุงูุจูู"
- **SY-03**: "ุฅุนุงุฏุฉ ุชูููู ุงูุจูุงูุงุช"

#### 4๏ธโฃ Events That Must NOT Appear
- ูุดู ุงูุงุณุชูุฑุงุฏ ุฃู ููุน ุงูุฏุฎูู
- ุฅุนุงุฏุฉ ุญุณุงุจ Scores ุจุฏูู ุฃุซุฑ
- ุงูุชุดุงู ุชุนุงุฑุถ ุจุฏูู ุชุบููุฑ ุญุงูุฉ
- ุฃู ุชูุงุนู ุนุฑุถู (ูุชุญ/ุชููู)

#### 5๏ธโฃ Mandatory Snapshot Rules
- ูู ุญุฏุซ = **Snapshot Before** ุฅูุฒุงูู.
- **Snapshot After** ุนูุฏ ูุฌูุฏ ุชุบููุฑ.
- **Description** ูููู ููุท (Before โ After).
- *ูุง ูุตูุต ุชูุณูุฑูุฉ ุฏุงุฎู Description.*

#### 6๏ธโฃ ุงูููุงุนุฏ ุงูุฐูุจูุฉ
- **LE-00** ูู ุงูุจุฏุงูุฉ ุฏุงุฆููุง.
- **No Change โ No Event.**
- **One Change โ One Event.**
- **Conflict** ููุฐูุฑ ููุท ุฅุฐุง ุบููุฑ ุงูุญุงูุฉ.
