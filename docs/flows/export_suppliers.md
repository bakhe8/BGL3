# Flow: تصدير الموردين (export_suppliers)

## الهدف
تصدير بيانات الموردين (أو subset) لتقارير أو أنظمة خارجية.

## المسار الأساسي
1) الطلب: `/api/export_suppliers.php` (اختياري: فلاتر/مدى تاريخ).
2) التحقق:
   - صلاحيات القراءة للمستخدم/الوكيل.
   - حجم النتيجة ضمن الحدود (إلا إذا أضيف paging/streaming).
3) التنفيذ:
   - جلب البيانات مع الفلاتر.
   - تطبيق تنقية للحقول الحساسة إن لزم.
   - إنشاء ملف (CSV/XLSX) وإرجاعه/رابط تحميل.
4) المخرجات:
   - ملف أو رابط تحميل.
   - حدث runtime_events `export_suppliers` مع counters.

## الأخطاء الشائعة
- صلاحيات ناقصة → 403.
- حجم كبير دون paging → قد يسبب بطء أو خطأ ذاكرة.

## الحواجز
- استعلامات مفهرسة (playbook caching/indexing).
- قيود حجم/صفحات.
- Audit لسجلات التصدير (من طلبه ومتى).

## معايير القبول
- تصدير بفلاتر صغيرة ينجح ويعيد ملفاً صالحاً.
- تصدير كبير يُقيّد أو يُجزّأ مع تحذير/رسالة مناسبة.
