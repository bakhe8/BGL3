rules:
- id: RS001
  name: Automated Writability Check
  description: Verify file/folder permissions before performing write operations.
  action: WARN
  rationale: Prevents task failure and partial writes when OS denies access.
  scope: filesystem
- id: RS002
  name: Sandbox Vendor Link Guard
  description: Skip creating vendor junction if target exists to avoid mklink errors.
  action: INFO
  rationale: Documents the current sandbox behavior; prevents noisy failures.
- id: RS003
  name: Canonical Rename Pipeline Enforcement
  description: rename_class must follow playbook rename_class (update refs incl. tests,
    refresh autoload, use sandbox DB copy). PHPUnit must not run before autoload refresh.
  action: WARN
  rationale: Prevents inconsistent state during rename; avoids repeated failures.
  scope: sandbox
- id: RS004
  name: Production Mode Write Lock
  description: When PRODUCTION_MODE is enabled, all API write operations must be centrally
    blocked (e.g., in autoload/middleware) with explicit 403, except whitelisted maintenance
    endpoints.
  action: WARN
  rationale: Prevents تسلل بيانات اختبار/تعديلات غير مقصودة في بيئة الإنتاج.
  scope: api
- id: RS005
  name: Rate Limit Guard
  description: API write endpoints should enforce a rate limiting middleware/guard
    with configurable thresholds.
  action: WARN
  rationale: يمنع إساءة الاستخدام والضغط المفاجئ على مسارات الكتابة.
  scope: api
- id: RS006
  name: audit_trail_required
  description: Ensure audit trail exists for CRUD on banks/suppliers
  action: WARN
  rationale: Track sensitive changes for compliance
  scope: app
- id: RS007
  name: data_validation_required
  description: Enforce email/phone validation on write/import
  action: WARN
  rationale: Prevent bad data and user-facing errors
  scope: app
- id: RS008
  name: alerts_on_failures
  description: Alert on repeated API/import failures
  action: WARN
  rationale: Early warning for production incidents
  scope: api
- id: RS009
  name: caching_for_reports
  description: Add caching for heavy dashboard/report queries
  action: WARN
  rationale: Improve performance while respecting consistency
  scope: app
- id: RS010
  name: critical_tests_presence
  description: Critical PHPUnit group for create/update/export
  action: WARN
  rationale: Guard key flows with fast tests
  scope: tests
- id: RS011
  name: settings_ux_feedback
  description: Settings page should auto-save with user/time indicator
  action: WARN
  rationale: Reduce config errors and improve UX
  scope: ui
- id: RS012
  name: import_safety_guards
  description: Enforce size/type checks and sanitization on imports
  action: WARN
  rationale: Prevent crashes and unsafe data on bulk imports
  scope: api
- id: RS013
  name: backup_export_available
  description: Provide lightweight backup/export with partial restore
  action: WARN
  rationale: Recoverability for critical master data
  scope: ops
- id: RS_454
  name: Auto rule for 454
  description: Ensure playbook 454 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_560
  name: Auto rule for 560
  description: Ensure playbook 560 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_689
  name: Auto rule for 689
  description: Ensure playbook 689 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_690
  name: Auto rule for 690
  description: Ensure playbook 690 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_699
  name: Auto rule for 699
  description: Ensure playbook 699 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_716
  name: Auto rule for 716
  description: Ensure playbook 716 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_717
  name: Auto rule for 717
  description: Ensure playbook 717 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_726
  name: Auto rule for 726
  description: Ensure playbook 726 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_743
  name: Auto rule for 743
  description: Ensure playbook 743 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_744
  name: Auto rule for 744
  description: Ensure playbook 744 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_753
  name: Auto rule for 753
  description: Ensure playbook 753 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_770
  name: Auto rule for 770
  description: Ensure playbook 770 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_771
  name: Auto rule for 771
  description: Ensure playbook 771 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_790
  name: Auto rule for 790
  description: Ensure playbook 790 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_791
  name: Auto rule for 791
  description: Ensure playbook 791 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_800
  name: Auto rule for 800
  description: Ensure playbook 800 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_PAT_PHASE3_INTEGRITY
  name: Auto rule for PAT_PHASE3_INTEGRITY
  description: Ensure playbook PAT_PHASE3_INTEGRITY is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_825
  name: Auto rule for 825
  description: Ensure playbook 825 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_842
  name: Auto rule for 842
  description: Ensure playbook 842 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_859
  name: Auto rule for 859
  description: Ensure playbook 859 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_878
  name: Auto rule for 878
  description: Ensure playbook 878 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-09'
- id: RS_895
  name: Auto rule for 895
  description: Ensure playbook 895 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_905
  name: Auto rule for 905
  description: Ensure playbook 905 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_938
  name: Auto rule for 938
  description: Ensure playbook 938 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1003
  name: Auto rule for 1003
  description: Ensure playbook 1003 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1020
  name: Auto rule for 1020
  description: Ensure playbook 1020 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1058
  name: Auto rule for 1058
  description: Ensure playbook 1058 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1076
  name: Auto rule for 1076
  description: Ensure playbook 1076 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1119
  name: Auto rule for 1119
  description: Ensure playbook 1119 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1154
  name: Auto rule for 1154
  description: Ensure playbook 1154 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1171
  name: Auto rule for 1171
  description: Ensure playbook 1171 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1188
  name: Auto rule for 1188
  description: Ensure playbook 1188 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1205
  name: Auto rule for 1205
  description: Ensure playbook 1205 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1214
  name: Auto rule for 1214
  description: Ensure playbook 1214 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-10'
- id: RS_1223
  name: Auto rule for 1223
  description: Ensure playbook 1223 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1240
  name: Auto rule for 1240
  description: Ensure playbook 1240 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1257
  name: Auto rule for 1257
  description: Ensure playbook 1257 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1274
  name: Auto rule for 1274
  description: Ensure playbook 1274 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1327
  name: Auto rule for 1327
  description: Ensure playbook 1327 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1354
  name: Auto rule for 1354
  description: Ensure playbook 1354 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1387
  name: Auto rule for 1387
  description: Ensure playbook 1387 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1414
  name: Auto rule for 1414
  description: Ensure playbook 1414 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1489
  name: Auto rule for 1489
  description: Ensure playbook 1489 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1516
  name: Auto rule for 1516
  description: Ensure playbook 1516 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1528
  name: Auto rule for 1528
  description: Ensure playbook 1528 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1548
  name: Auto rule for 1548
  description: Ensure playbook 1548 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-11'
- id: RS_1569
  name: Auto rule for 1569
  description: Ensure playbook 1569 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1607
  name: Auto rule for 1607
  description: Ensure playbook 1607 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1615
  name: Auto rule for 1615
  description: Ensure playbook 1615 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1630
  name: Auto rule for 1630
  description: Ensure playbook 1630 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1647
  name: Auto rule for 1647
  description: Ensure playbook 1647 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1664
  name: Auto rule for 1664
  description: Ensure playbook 1664 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1681
  name: Auto rule for 1681
  description: Ensure playbook 1681 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1698
  name: Auto rule for 1698
  description: Ensure playbook 1698 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1715
  name: Auto rule for 1715
  description: Ensure playbook 1715 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-12'
- id: RS_1753
  name: Auto rule for 1753
  description: Ensure playbook 1753 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1767
  name: Auto rule for 1767
  description: Ensure playbook 1767 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1781
  name: Auto rule for 1781
  description: Ensure playbook 1781 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1822
  name: Auto rule for 1822
  description: Ensure playbook 1822 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1900
  name: Auto rule for 1900
  description: Ensure playbook 1900 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1909
  name: Auto rule for 1909
  description: Ensure playbook 1909 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1918
  name: Auto rule for 1918
  description: Ensure playbook 1918 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1929
  name: Auto rule for 1929
  description: Ensure playbook 1929 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1940
  name: Auto rule for 1940
  description: Ensure playbook 1940 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1951
  name: Auto rule for 1951
  description: Ensure playbook 1951 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_1992
  name: Auto rule for 1992
  description: Ensure playbook 1992 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_2003
  name: Auto rule for 2003
  description: Ensure playbook 2003 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_2028
  name: Auto rule for 2028
  description: Ensure playbook 2028 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_2045
  name: Auto rule for 2045
  description: Ensure playbook 2045 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
- id: RS_2064
  name: Auto rule for 2064
  description: Ensure playbook 2064 is applied
  action: WARN
  rationale: Auto-generated from approved playbook
  scope:
  - '*'
  origin: auto_generated
  created: '2026-02-13'
